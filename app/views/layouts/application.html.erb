<!DOCTYPE html>
<%# アプリケーション全体のレイアウトを定義するテンプレート %>
<html>
  <head>
    <%# タイトルタグ - content_forで個別ページのタイトルを設定可能、未設定時はデフォルトで"EduFinTech" %>
    <title><%= content_for(:title) || "EduFinTech" %></title>

    <%# モバイル対応のためのメタタグ設定 %>
    <%# レスポンシブデザイン対応のビューポート設定 %>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%# iOSでフルスクリーン表示を可能にする設定 %>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <%# Androidでフルスクリーン表示を可能にする設定 %>
    <meta name="mobile-web-app-capable" content="yes">

    <%# セキュリティ関連のメタタグ %>
    <%# CSRF対策のためのメタタグ - クロスサイトリクエストフォージェリを防止 %>
    <%= csrf_meta_tags %>
    <%# CSP(Content Security Policy)のためのメタタグ - XSSなどの攻撃を防止 %>
    <%= csp_meta_tag %>

    <%# 個別ページで追加のhead要素を挿入可能なyieldポイント %>
    <%= yield :head %>

    <%# PWA(Progressive Web App)のマニフェストファイル設定 - 現在は未使用 %>
    <%#= tag.link rel: "manifest", href: pwa_manifest_path(format: :json) %>

    <%# アプリケーションのアイコン設定 %>
    <%# 通常のファビコン、SVGファビコン、iOS用アイコンを設定 %>
    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="icon" href="/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/icon.png">

    <%# アセットの読み込み %>
    <%# Turboでの追跡を有効化したスタイルシートの読み込み %>
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%# JavaScriptのimportmapを使用したモジュールの読み込み %>
    <%= javascript_importmap_tags %>
  </head>

  <%# 最小高さをビューポート高に設定し、背景色をグレーに %>
  <body class="h-screen flex flex-col bg-gray-50">
    <%# ヘッダー - カスタムスタイルを適用 %>
    <header class="header">
      <div class="header-container">
        <%# ロゴ - 左寄せ %>
        <%= link_to "EduFinTech", root_path, class: "header-logo" %>

        <%# ナビゲーションメニュー - 右寄せ %>
        <nav class="header-nav">
          <%# ログイン状態に応じてメニューを切り替え %>
          <% if user_signed_in? %>
            <%# ログイン済みの場合 %>
            <%= link_to "投稿一覧", posts_path, class: "nav-button nav-button-login" %>
            <%= link_to "新規投稿", new_post_path, class: "nav-button nav-button-login" %>
            <%= link_to "マイページ", user_path(current_user), class: "nav-button nav-button-login" %>
            <%= button_to "ログアウト", destroy_user_session_path, method: :delete, class: "nav-button nav-button-signup" %>
          <% else %>
            <%# 未ログインの場合 %>
            <%= link_to "ログイン", new_user_session_path, class: "nav-button nav-button-login" %>
            <%= link_to "新規登録", new_user_registration_path, class: "nav-button nav-button-signup" %>
          <% end %>
        </nav>
      </div>
    </header>

    <%# メインコンテンツ - スクロール可能な領域として設定 %>
    <main class="flex-1 overflow-auto">
      <%# フラッシュメッセージ - シンプルなテキストベースのデザイン %>
      <% if notice %>
        <div class="bg-green-50 border-l-4 border-green-400 p-4">
          <div class="flex">
            <div class="flex-shrink-0">
              <p class="text-sm text-green-700"><%= notice %></p>
            </div>
          </div>
        </div>
      <% end %>
      <% if alert %>
        <div class="bg-red-50 border-l-4 border-red-400 p-4">
          <div class="flex">
            <div class="flex-shrink-0">
              <p class="text-sm text-red-700"><%= alert %></p>
            </div>
          </div>
        </div>
      <% end %>

      <%# ページコンテンツ %>
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
        <%= yield %>
      </div>
    </main>

    <%# フッター - 濃いグレーの背景色で区別 %>
    <footer class="h-8 bg-gray-800 border-t border-gray-700">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-full flex items-center justify-center">
        <p class="text-sm text-gray-300">&copy; <%= Time.current.year %> EduFinTech. All rights reserved.</p>
      </div>
    </footer>
  </body>
</html>
